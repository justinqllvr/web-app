<%= simple_form_for @report do |f| %>
 <div class="form-group  ">Quel probl√®me voulez signaler ?</div>
  <div class="row justify-content-center" style="padding-top: 5px;"><%= f.input :title, placeholder: "Titre", :label=> false %></div>
  <div class="row justify-content-center" style="padding-top: 5px;"><%= f.input :text, placeholder: "Description", :label=> false %></div>
  <div class="row justify-content-center" style="padding-top: 5px;"><%= f.input :latitude, placeholder: "Latitude", :input_html => { :id => "latitude" } %></div>
  <div class="row justify-content-center" style="padding-top: 5px;"><%= f.input :longitude, placeholder: "Longitude", :input_html => { :id => "longitude" } %></div>
  <div class="row justify-content-center" style="padding-top: 5px;"><%= f.input :picture %></div>
  <div class="row justify-content-center" style="padding-top: 5px;"><%= f.button :submit, value: "Enregistrer", class:"btn-success", id: "valider" %></div>
<% end %>

<div id="alert-localisation"></div>
<div class="row justify-content-center" style="padding-top: 5px;"><button class="btn btn-outline-success" id="btn-loc">Localiser position</button></div>

<!-- Localisation script-->
<script type="text/javascript">
 window.onload = function() {
 var btn = document.getElementById("btn-loc");
 var long = document.getElementById("longitude");
 var lat = document.getElementById("latitude");
 var alertLoc = document.getElementById("alert-localisation");

 btn.addEventListener("click", getLocation);


 function getLocation() {
   if (navigator.geolocation) {
     navigator.geolocation.getCurrentPosition(showPosition);
     // navigator.geolocation.watchPosition(showPosition, showError);
   } else {
     alertLoc.innerHTML = "Geolocation is not supported by this browser.";
   }

   function showPosition(position) {
     console.log('position');
     lat.value = position.coords.latitude;
     long.value = position.coords.longitude;

     document.getElementById("valider").disabled = false;

   }

   function showError(error) {
     console.log('error');
     switch(error.code) {
       case error.PERMISSION_DENIED:
         alertLoc.innerHTML = "User denied the request for Geolocation."
         break;
       case error.POSITION_UNAVAILABLE:
         alertLoc.innerHTML = "Location information is unavailable."
         break;
       case error.TIMEOUT:
         alertLoc.innerHTML = "The request to get user location timed out."
         break;
       case error.UNKNOWN_ERROR:
         alertLoc.innerHTML = "An unknown error occurred."
         break;
     }
   }
 }
}
</script>