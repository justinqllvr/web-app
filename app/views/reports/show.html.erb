
<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap"async defer></script>
<div class="container-fluid">
  <div class="row">
    <div class="col-md-6 mt-5">
      <%= image_tag @report.picture.url(angle: :exif), class: 'img-fluid' %>
      <span class="badge badge-primary"><%= @report.likes.count %> soutiens</span>
      <h1 class="mt-3"><%= @report.title %></h1>
      <p><%= @report.text %></p>
      <div class="d-flex" style="flex-direction: row;">
        <% if current_user %>
          <%= link_to 'Edit', edit_report_path(@report), class: 'btn btn-info' if @report.user == current_user || current_user.admin %>
          <% existing_like = @report.likes.find { |like| like.user_id == current_user.id} %>
            <% if existing_like %>
              <%= button_to 'Je ne soutiens plus', report_like_path(@report, existing_like), method: :delete, class: 'btn btn-danger ' %>
            <% else %>
              <%= button_to 'Je soutiens', report_likes_path(@report), method: :post, class: 'btn btn-success ' %>
            <% end %>
        <% end %>
      </div>
    </div>
    <div class="d-flex col-md-6 mt-5">
      <div class=""id="map" style="height: 85vh; width: 100%;"></div>
      <script>
        function initMap() {

            var map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: <%= @report.latitude %>, lng: <%= @report.longitude %>},
                zoom: 16,
            });  

            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(<%= @report.latitude %>, <%= @report.longitude %>),
            });

            marker.setMap(map);

        }
      </script>
    </div>
  </div>
</div>


